---
title: "Gene Name Errors Screen"
author: "Mandhri Abeysooriya & Mark Ziemann"
date: "`r Sys.Date()`"
output:
  html_document:
    toc: yes
  pdf_document:
    toc: yes
theme: cosmo
---

```{r,library_load}

library("dplyr")
library("kableExtra")
library("eulerr")
library("Cairo")
options(bitmapType="cairo")

```

## Introduction

The bash script "gene_names.sh" was used to screen a list of PMC articles and here 
we are processing and analysing the output of the script to generate figures 
that will be needed in the paper

## Number of publications 

The number of publications available in each year from 2014 to 2020 in PUBMED CENTRAL.
These publications were selected through a search in PubMed Central using the key word,"genom"

```{r,publication_amount read}

pmc2014 <- read.table("pmc/genom/pmc2014.txt")
pmc2014 <- nrow(pmc2014)
pmc2015 <- read.table("pmc/genom/pmc2015.txt")
pmc2015 <- nrow(pmc2015)
pmc2016 <- read.table("pmc/genom/pmc2016.txt")
pmc2016 <- nrow(pmc2016)
pmc2017 <- read.table("pmc/genom/pmc2017.txt")
pmc2017 <- nrow(pmc2017)
pmc2018 <- read.table("pmc/genom/pmc2018.txt")
pmc2018 <- nrow(pmc2018)
pmc2019 <- read.table("pmc/genom/pmc2019.txt")
pmc2019 <- nrow(pmc2019)
pmc2020 <- read.table("pmc/genom/pmc2020.txt")
pmc2020 <- nrow(pmc2020)
total_pmc <- sum(pmc2014,pmc2015,pmc2016,pmc2017,pmc2018,pmc2019,pmc2020)
pmc <- c(pmc2014,pmc2015,pmc2016,pmc2017,pmc2018,pmc2019,pmc2020,total_pmc)

```

## Number of supplementary files

The number of publications resulted from the "genom" keyword search from 2014 to 
2020 was short listed where the publications with supplementary files were downloaded.

These supplementary files were selected in a manner in which supplementary files 
compose of ".xls" or ".xlsx" suffixes were assumed to be supplementary excel files.

```{r,supplementary_files_amount}

res2014 <- readLines("results/genom/results2014.txt")
res2014_length <- length(unique(sapply(strsplit(res2014," "),"[[",1)))
res2015 <- readLines("results/genom/results2015.txt")
res2015_length <- length(unique(sapply(strsplit(res2015," "),"[[",1)))
res2016 <- readLines("results/genom/results2016.txt")
res2016_length <- length(unique(sapply(strsplit(res2016," "),"[[",1)))
res2017 <- readLines("results/genom/results2017.txt")
res2017_length <- length(unique(sapply(strsplit(res2017," "),"[[",1)))
res2018 <- readLines("results/genom/results2018.txt")
res2018_length <- length(unique(sapply(strsplit(res2018," "),"[[",1)))
res2019 <- readLines("results/genom/results2019.txt")
res2019_length <- length(unique(sapply(strsplit(res2019," "),"[[",1)))
res2020 <- readLines("results/genom/results2020.txt")
res2020_length <- length(unique(sapply(strsplit(res2020," "),"[[",1)))
total_res <- sum(res2014_length,res2015_length,res2016_length,res2017_length,
  res2018_length,res2019_length,res2020_length)
res <- c(res2014_length,res2015_length,res2016_length,res2017_length,
  res2018_length,res2019_length,res2020_length,total_res)

```

## Excel files with gene lists 

All the supplementary files downloaded from 2014 to 2020 where searched for a 
gene list in a way that each supplementary files' content were analysed for their 
length.

If a supplementary file content is depicting a length greater than 2, it is 
verified as a supplementary file containing of a gene list. 

```{r,xl_files_with_genelist}

res2014_l <- strsplit(res2014," ")
res2014_xlg <- res2014_l[which(lapply(res2014_l,length)>2)]
res2014_xlg <- length(unique(sapply(res2014_xlg,"[[",2)))
res2015_l <- strsplit(res2015," ")
res2015_xlg <- res2015_l[which(lapply(res2015_l,length)>2)]
res2015_xlg <- length(unique(sapply(res2015_xlg,"[[",2)))
res2016_l <- strsplit(res2016," ")
res2016_xlg <- res2016_l[which(lapply(res2016_l,length)>2)]
res2016_xlg <- length(unique(sapply(res2016_xlg,"[[",2)))
res2017_l <- strsplit(res2017," ")
res2017_xlg <- res2017_l[which(lapply(res2017_l,length)>2)]
res2017_xlg <- length(unique(sapply(res2017_xlg,"[[",2)))
res2018_l <- strsplit(res2018," ")
res2018_xlg <- res2018_l[which(lapply(res2018_l,length)>2)]
res2018_xlg <- length(unique(sapply(res2018_xlg,"[[",2)))
res2019_l <- strsplit(res2019," ")
res2019_xlg <- res2019_l[which(lapply(res2019_l,length)>2)]
res2019_xlg <- length(unique(sapply(res2019_xlg,"[[",2)))
res2020_l <- strsplit(res2020," ")
res2020_xlg <- res2020_l[which(lapply(res2020_l,length)>2)]
res2020_xlg <- length(unique(sapply(res2020_xlg,"[[",2)))

total_pub_xlg <- sum(res2014_xlg,res2015_xlg,res2016_xlg,res2017_xlg,res2018_xlg,res2019_xlg,res2020_xlg)

pub_xlg <- c(res2014_xlg,res2015_xlg,res2016_xlg,res2017_xlg,res2018_xlg,res2019_xlg,res2020_xlg,total_pub_xlg)

```

## Publications with Excel gene lists

The results from the excel files with gene lists were shortlisted in a manner 
where the related publication for each supplementary file with excel gene list 
was selected.

```{r,publications_with_xlgene}

res2014_l <- strsplit(res2014," ")
res2014_lx <- res2014_l[which(lapply(res2014_l,length)>2)]
res2014_lx <- length(unique(sapply(res2014_lx,"[[",1)))
res2015_l <- strsplit(res2015," ")
res2015_lx <- res2015_l[which(lapply(res2015_l,length)>2)]
res2015_lx <- length(unique(sapply(res2015_lx,"[[",1)))
res2016_l <- strsplit(res2016," ")
res2016_lx <- res2016_l[which(lapply(res2016_l,length)>2)]
res2016_lx <- length(unique(sapply(res2016_lx,"[[",1)))
res2017_l <- strsplit(res2017," ")
res2017_lx <- res2017_l[which(lapply(res2017_l,length)>2)]
res2017_lx <- length(unique(sapply(res2017_lx,"[[",1)))
res2018_l <- strsplit(res2018," ")
res2018_lx <- res2018_l[which(lapply(res2018_l,length)>2)]
res2018_lx <- length(unique(sapply(res2018_lx,"[[",1)))
res2019_l <- strsplit(res2019," ")
res2019_lx <- res2019_l[which(lapply(res2019_l,length)>2)]
res2019_lx <- length(unique(sapply(res2019_lx,"[[",1)))
res2020_l <- strsplit(res2020," ")
res2020_lx <- res2020_l[which(lapply(res2020_l,length)>2)]
res2020_lx <- length(unique(sapply(res2020_lx,"[[",1)))
total_pub_xls <- sum(res2014_lx,res2015_lx,res2016_lx,res2017_lx,res2018_lx,res2019_lx,res2020_lx)
pub_xls <- c(res2014_lx,res2015_lx,res2016_lx,res2017_lx,res2018_lx,res2019_lx,res2020_lx,total_pub_xls)

```

## Publications with suspected gene name errors

The resulted publications with excel gene list were run in a shell scripted 
software where each selected publications with excel gene list were screened for 
their gene symbols.

Erroneous conversions, such as date formats, scientific numbers and five-digit 
numbers were chosen from gene lists as gene name errors and the results were recorded 
and saved as "aggregated_res". 

This aggregated_res file composed of PMCID, Species, Journal name, year and the 
link to the affected file.

Total suspected publications with gene name errors were detected from 
aggregated_res file and aggregated_res file was analysed in a manner where 
publications with gene name errors for each year were also extracted.

```{r,pubs_with_suspected_errors}

aggregated_res <- readLines("results/genom/aggregated_res.txt")
head(aggregated_res)
total_sus_pub <- length(unique(sapply(strsplit(aggregated_res," "),"[[",1)))
total_sus_pub

sus_pub <- sapply(strsplit(aggregated_res," "),"[[",1)
sus_pub_year <- sapply(strsplit(aggregated_res," "),"[[",3)
sus_pub_file <- sapply(strsplit(aggregated_res," "),"[[",4)
suspected_df <- data.frame(sus_pub,sus_pub_year,sus_pub_file)

sus_pub_2014_df <- subset(suspected_df[suspected_df$sus_pub_year=="results2014.txt",])
sus_pub_2014 <- length(unique(sus_pub_2014_df$sus_pub))
sus_pub_2015_df <- subset(suspected_df[suspected_df$sus_pub_year=="results2015.txt",])
sus_pub_2015 <- length(unique(sus_pub_2015_df$sus_pub))
sus_pub_2016_df <- subset(suspected_df[suspected_df$sus_pub_year=="results2016.txt",])
sus_pub_2016 <- length(unique(sus_pub_2016_df$sus_pub))
sus_pub_2017_df <- subset(suspected_df[suspected_df$sus_pub_year=="results2017.txt",])
sus_pub_2017 <- length(unique(sus_pub_2017_df$sus_pub))
sus_pub_2018_df <- subset(suspected_df[suspected_df$sus_pub_year=="results2018.txt",])
sus_pub_2018 <- length(unique(sus_pub_2018_df$sus_pub))
sus_pub_2019_df <- subset(suspected_df[suspected_df$sus_pub_year=="results2019.txt",])
sus_pub_2019 <- length(unique(sus_pub_2019_df$sus_pub))
sus_pub_2020_df <- subset(suspected_df[suspected_df$sus_pub_year=="results2020.txt",])
sus_pub_2020 <- length(unique(sus_pub_2020_df$sus_pub))

sus_pub <- c(sus_pub_2014,sus_pub_2015,sus_pub_2016,sus_pub_2017,
  sus_pub_2018,sus_pub_2019,sus_pub_2020,total_sus_pub)

```

## Affected XLS files

aggregated_res file was analysed for the total number of spread files which 
contained gene name errors and the final result was saved as "affected_xl"

```{r,total_affectedxls}

affected_xl <- length(sapply(strsplit(aggregated_res," "),"[[",1))
affected_xl

```
## False positive XLS files

In order to reconfirm the results obtained each spreadsheet in aggregated_res 
file was manually opened to validate accuracy of the data 
and final result was updated in the "aggregated_res" file.
In the manual search of aggregated_res for validating accuracy of data in the file,
several false positive excel files were recorded 
and these false positive results were saved in a text file named "fp.txt"

fp.txt file was read as "false positive".
Total number of false positive results were recorded from "fp.txt" 
and saved as "total_fp_xls".
"false positive" was reanalysed based on the year (2014 to 2020) to obtain number 
of false positive excel files for each year.

```{r,fp_xls}

fp <- read.table("results/genom/false_positive.txt")
total_fp_xls <- length(fp$V1)
total_fp_xls

fp_2014 <- subset(fp[fp$V4==2014,])
fp_2014_xls <- length(fp_2014$V1)
fp_2015 <- subset(fp[fp$V4==2015,])
fp_2015_xls <- length(fp_2015$V1)
fp_2016 <- subset(fp[fp$V4==2016,])
fp_2016_xls <- length(fp_2016$V1)
fp_2017 <- subset(fp[fp$V4==2017,])
fp_2017_xls <- length(fp_2017$V1)
fp_2018 <- subset(fp[fp$V4==2018,])
fp_2018_xls <- length(fp_2018$V1)
fp_2019 <- subset(fp[fp$V4==2019,])
fp_2019_xls <- length(fp_2019$V1)
fp_2020 <- subset(fp[fp$V4==2020,])
fp_2020_xls <- length(fp_2020$V1)

fp_xls <- c(fp_2014_xls,fp_2015_xls,fp_2016_xls,
  fp_2017_xls,fp_2018_xls,fp_2019_xls,
  fp_2020_xls,total_fp_xls)

```

## False positive publications

"fp" was reannalysed for the total number of false positive publications 
and the result was saved as "total_fp_pub".
"false positive" was reanalysed based on the year(2014 to 2020) to obtain number
of false positive publications for each year.

```{r,fp_pub}

total_fp_pub <- length(unique(fp$V1))
fp_2014 <- subset(fp[fp$V4==2014,])
fp_2014_pub <- length(unique(fp_2014$V1))
fp_2015 <- subset(fp[fp$V4==2015,])
fp_2015_pub <- length(unique(fp_2015$V1))
fp_2016 <- subset(fp[fp$V4==2016,])
fp_2016_pub <- length(unique(fp_2016$V1))
fp_2017 <- subset(fp[fp$V4==2017,])
fp_2017_pub <- length(unique(fp_2017$V1))
fp_2018 <- subset(fp[fp$V4==2018,])
fp_2018_pub <- length(unique(fp_2018$V1))
fp_2019 <- subset(fp[fp$V4==2019,])
fp_2019_pub <- length(unique(fp_2019$V1))
fp_2020 <- subset(fp[fp$V4==2020,])
fp_2020_pub <- length(unique(fp_2020$V1))

fp_pub <- c(fp_2014_pub,fp_2015_pub,fp_2016_pub,
  fp_2017_pub,fp_2018_pub,fp_2019_pub,
  fp_2020_pub,total_fp_pub)

```

## Affected files

In order to reconfirm the results obtained each spreadsheet in aggregated_res 
file was manually opened to validate accuracy of the data 
and final result was saved in "true_positive.txt" file.

true_positive.txt" file was read as affected xls.
Total number of true positive excel files with gene name errors from the 
"true_positive.txt" was obtained and the result was saved as "total_aff_xls"

"affected.xls" was reanalysed based on the year(2014 to 2020) to obtain number 
of true positive excel files for each year.

```{r,aff_xls}

aff_xls <- read.table("results/genom/true_positive.txt")
total_aff_xls <- nrow(aff_xls)
total_aff_xls

aff_xls_2014 <- subset(aff_xls[aff_xls$V4==2014,])
aff_xls_2014 <- length(aff_xls_2014$V1)
aff_xls_2015 <- subset(aff_xls[aff_xls$V4==2015,])
aff_xls_2015 <- length(aff_xls_2015$V1)
aff_xls_2016 <- subset(aff_xls[aff_xls$V4==2016,])
aff_xls_2016 <- length(aff_xls_2016$V1)
aff_xls_2017 <- subset(aff_xls[aff_xls$V4==2017,])
aff_xls_2017 <- length(aff_xls_2017$V1)
aff_xls_2018 <- subset(aff_xls[aff_xls$V4==2018,])
aff_xls_2018 <- length(aff_xls_2018$V1)
aff_xls_2019 <- subset(aff_xls[aff_xls$V4==2019,])
aff_xls_2019 <- length(aff_xls_2019$V1)
aff_xls_2020 <- subset(aff_xls[aff_xls$V4==2020,])
aff_xls_2020 <- length(aff_xls_2020$V1)

aff_xls_files <- c(aff_xls_2014,aff_xls_2015,aff_xls_2016,
  aff_xls_2017,aff_xls_2018,aff_xls_2019,
  aff_xls_2020,total_aff_xls)

```
## Affected publications

"aff_xls" was reannalysed for the total number of true positive publications
and the result was saved as "total_aff_pub".
"aff_xls" was reanalysed based on the year(2014 to 2020) to obtain number
of true positive publications for each year.

```{r,affectedpublications}

aff_xls <- read.table("results/genom/true_positive.txt")
total_aff_pub <- length(unique(aff_xls$V1))
total_aff_pub

pub_2014 <- subset(aff_xls[aff_xls$V4==2014,])
aff_pub_2014 <- length(unique(pub_2014$V1))
pub_2015 <- subset(aff_xls[aff_xls$V4==2015,])
aff_pub_2015 <- length(unique(pub_2015$V1))
pub_2016 <- subset(aff_xls[aff_xls$V4==2016,])
aff_pub_2016 <- length(unique(pub_2016$V1))
pub_2017 <- subset(aff_xls[aff_xls$V4==2017,])
aff_pub_2017 <- length(unique(pub_2017$V1))
pub_2018 <- subset(aff_xls[aff_xls$V4==2018,])
aff_pub_2018 <- length(unique(pub_2018$V1))
pub_2019 <- subset(aff_xls[aff_xls$V4==2019,])
aff_pub_2019 <- length(unique(pub_2019$V1))
pub_2020 <- subset(aff_xls[aff_xls$V4==2020,])
aff_pub_2020 <- length(unique(pub_2020$V1))

aff_pub <- c(aff_pub_2014,aff_pub_2015,aff_pub_2016,aff_pub_2017,aff_pub_2018,aff_pub_2019,aff_pub_2020,total_aff_pub)

```

## Proportion of Excel gene lists articles containing errors

"total_aff_pub" was divided by "total_pub_xls" and multiple by 100 to find 
the proportion (%) of excel gene lists articles which contain gene name errors.
The final answer was recorded to 3 significant figures and the result was saved 
as "total_aff_pub".
Figures below are precentages.

```{r,excelgenelist_paper_error_percentages}

Total_percent_of_errors <- signif(total_aff_pub/total_pub_xls*100,3)
Total_percent_of_errors

percentage_2014 <- signif(aff_pub_2014/res2014_lx*100,3)
percentage_2015 <- signif(aff_pub_2015/res2015_lx*100,3)
percentage_2016 <- signif(aff_pub_2016/res2016_lx*100,3)
percentage_2017 <- signif(aff_pub_2017/res2017_lx*100,3)
percentage_2018 <- signif(aff_pub_2018/res2018_lx*100,3)
percentage_2019 <- signif(aff_pub_2019/res2019_lx*100,3)
percentage_2020 <- signif(aff_pub_2020/res2020_lx*100,3)

percentages <- c(percentage_2014,percentage_2015,percentage_2016,percentage_2017,
  percentage_2018,percentage_2019,percentage_2020,Total_percent_of_errors)

```

## Table 3 of the manuscript

Table 3. Results of a screen for gene name errors in PubMed Central. 

```{r,dataframe_years}

years <- c("2014","2015","2016","2017","2018","2019","2020","Total")
df_gene_name_errors_years <- data.frame(pmc,res,pub_xlg,pub_xls,sus_pub,fp_xls,fp_pub,aff_xls_files,aff_pub,percentages)
df_gene_name_errors_years <- cbind(years,df_gene_name_errors_years)

colnames(df_gene_name_errors_years) <- c(" ",
  "PMC ID",
  "Excel files screened",
  "Excel files with gene lists",
  "Publications with Excel gene lists",
  "Publications with suspected gene name errors",
  "False positive XLS files",
  "False positive publications",
  "Affected XLS files",
  "Affected publications",
  "Proportion of publications affected")

  df_gene_name_errors_years%>%
  kbl() %>%
  kable_paper("hover", full_width = F)
  
```

## Plots for figure 1 of the manuscript

Plots are created for the figure 1 in the manuscript which composed of results 
for prevalence of gene name errors in the period 2014-2020.

Accordingly, A .barplot for Publications with Excel gene lists. B. barplot for 
Affected publication and C. Line diagram for Proportion of publications affected

```{r,plots1,fig.height=9,fig.width=6}
pdf("fig1.pdf",width=4,height=7) 
par(mfrow=c(3,1))

#barplot for Publications with Excel gene lists
df <- df_gene_name_errors_years
df <- df[1:(nrow(df)-1),]

barplot(df[,5],names.arg = df[,1],ylab="Publications with Excel gene lists",ylim = c(0,2500))
grid(nx=0,ny=5,col = "gray")

#barplot for Affected publications
barplot(df[,10],names.arg = df[,1],ylab="Affected publications",ylim = c(0,800))
grid(nx=0,ny=8,col = "gray")

#Line diagram for Proportion of publications affected
plot(x=df[,1],y=df[,11],ylab ="Proportion of publications affected (%)",xlab = "",ylim = c(0,35),type = "b",pch=19,bty="n")
grid()
dev.off()

par(mfrow=c(3,1))
#barplot for Publications with Excel gene lists
df <- df_gene_name_errors_years
df <- df[1:(nrow(df)-1),]
barplot(df[,5],names.arg = df[,1],ylab="Publications with Excel gene lists",ylim = c(0,2500))
grid(nx=0,ny=5,col = "gray")

#barplot for Affected publications
barplot(df[,10],names.arg = df[,1],ylab="Affected publications",ylim = c(0,800))
grid(nx=0,ny=8,col = "gray")

#Line diagram for Proportion of publications affected

plot(x=df[,1],y=df[,11],ylab ="Proportion of publications affected (%)",xlab = "",ylim = c(0,35),type = "b",pch=19,bty="n")
grid()
```

## Gene name errors for different organisms

From the results obtained on the publications and excel spread sheets with gene name
errors, a reanalysation was performed to identify which organism composed of most 
number of errors in their name.

Each publication and excel sheet was screened for gene name errors.
Accordngly, A. thaliana, C. elegans, D. melanogaster, D. rerio, G. gallus, 
H. sapiens,M. musculus,O. sativa,R. norvegicus,S. cerevisiae species were 
selected and each publications and excel sheets composing of gene name errors
from 2014 to 2020 were screened. The obtained results were saved under each 
individual name of the species.

Proportion of article affected for each individual species was calculated and 
resulted percentage was saved to 3 significant figures.

```{r,gene_name_errors_organism}

res_all_years <- c(res2014,res2015,res2016,res2017,res2018,res2019,res2020)
res_all_years_l <- strsplit(res_all_years," ")
res_all_years_lx <- res_all_years_l[which(lapply(res_all_years_l,length)>2)]
pmid <- sapply(res_all_years_lx,"[[",1)
org <- sapply(res_all_years_lx,"[[",3)
org_df <- data.frame(pmid,org)

ath_pub <- length(unique(subset(org_df,org=="Athaliana")$pmid))
ath_aff <- length(unique(subset(aff_xls[aff_xls$V2=="Athaliana",])$V1))
ath_pc <- signif(ath_aff/ath_pub*100,3)

cel_pub <- length(unique(subset(org_df,org=="Celegans")$pmid))
cel_aff <- length(unique(subset(aff_xls[aff_xls$V2=="Celegans",])$V1))
cel_pc <- signif(cel_aff/cel_pub*100,3)

dme_pub <- length(unique(subset(org_df,org=="Dmelanogaster")$pmid))
dme_aff <- length(unique(subset(aff_xls[aff_xls$V2=="Dmelanogaster",])$V1))
dme_pc <- signif(dme_aff/dme_pub*100,3)

dre_pub <- length(unique(subset(org_df,org=="Drerio")$pmid))
dre_aff <- length(unique(subset(aff_xls[aff_xls$V2=="Drerio",])$V1))
dre_pc <- signif(dre_aff/dre_pub*100,3)

gga_pub <- length(unique(subset(org_df,org=="Ggallus")$pmid))
gga_aff <- length(unique(subset(aff_xls[aff_xls$V2=="Ggallus",])$V1))
gga_pc <- signif(gga_aff/gga_pub*100,3)

hsa_pub <- length(unique(subset(org_df,org=="Hsapiens")$pmid))
hsa_aff <- length(unique(subset(aff_xls[aff_xls$V2=="Hsapiens",])$V1))
hsa_pc <- signif(hsa_aff/hsa_pub*100,3)

mmu_pub <- length(unique(subset(org_df,org=="Mmusculus")$pmid))
mmu_aff <- length(unique(subset(aff_xls[aff_xls$V2=="Mmusculus",])$V1))
mmu_pc <- signif(mmu_aff/mmu_pub*100,3)

osa_pub <- length(unique(subset(org_df,org=="Osativa")$pmid))
osa_aff <- length(unique(subset(aff_xls[aff_xls$V2=="Osativa",])$V1))
osa_pc <- signif(osa_aff/osa_pub*100,3)

rno_pub <- length(unique(subset(org_df,org=="Rnorvegicus")$pmid))
rno_aff <- length(unique(subset(aff_xls[aff_xls$V2=="Rnorvegicus",])$V1))
rno_pc <- signif(rno_aff/rno_pub*100,3)

sce_pub <- length(unique(subset(org_df,org=="Scerevisiae")$pmid))
sce_aff <- length(unique(subset(aff_xls[aff_xls$V2=="Scerevisiae",])$V1))
sce_pc <- signif(sce_aff/sce_pub*100,3)

```

## Table 4 of the manuscript

A data frame was created which composed of Species, Publications with excel gene lists,
Affected publications and Proportion of artcles affected followed by generation of 
Table 4 in the manuscript.

```{r,dataframe_species}

Species <- c("A.thaliana","C.elegans","D.melanogaster","D.rerio","G.gallus",
  "H.sapiens","M.musculus","O.sativa","R.norvegicus","S.cerevisiae")

pub <- c(ath_pub, cel_pub, dme_pub, dre_pub, gga_pub, hsa_pub, mmu_pub, osa_pub, rno_pub, sce_pub)

aff <- c(ath_aff, cel_aff, dme_aff, dre_aff, gga_aff, hsa_aff, mmu_aff, osa_aff, rno_aff, sce_aff)

prop <- c(ath_pc, cel_pc, dme_pc, dre_pc, gga_pc, hsa_pc, mmu_pc, osa_pc, rno_pc, sce_pc)

gene_name_errors_species <- data.frame(Species,pub,aff,prop)

colnames(gene_name_errors_species) <- c("Species",
  "Publications with excel gene lists",
  "Affected publications",
  "Propotion of articles affected")

  gene_name_errors_species%>%
  kbl() %>%
  kable_paper("hover", full_width = F)

```

## Number of affected publications in different journals

Total number of journals index in PubMed Central was extraced for every year 
from 2014 to 2020 was obtained and result was saved as "jdf".
Total number of journals composing of one or more supplementary excel lists was 
calculated and result was saved as "res_p".
jdf_subset was created to evaluate repetition of the data obtained in "jdf" and
"res_p".

"journal_supplementary" was created to count number of journals with gene name 
errors in the supplementary files.
"jdf_t_df" was created to for number of articles with excel gene list by using 
"jdf_subset".
Number of affected articles was calculated using "aff_xls".

Table 5 in the manuscript was created from above gathered results.

```{r,gene_name_errors_journal}

#journals index in PMC
j2014 <- read.table("pmc/genom/pmc_journal2014genom.out.txt")
j2015 <- read.table("pmc/genom/pmc_journal2015genom.out.txt")
j2016 <- read.table("pmc/genom/pmc_journal2016genom.out.txt")
j2017 <- read.table("pmc/genom/pmc_journal2017genom.out.txt")
j2018 <- read.table("pmc/genom/pmc_journal2018genom.out.txt")
j2019 <- read.table("pmc/genom/pmc_journal2019genom.out.txt")
j2020 <- read.table("pmc/genom/pmc_journal2020genom.out.txt")
jdf <- rbind(j2014,j2015,j2016,j2017,j2018,j2019,j2020)
length(unique(jdf[,2]))
       
#journals published one or more supplementary Excel gene lists
res2014_xlg <- res2014_l[which(lapply(res2014_l,length)>2)]
res2014_p <- unique(sapply(res2014_xlg,"[[",1))
res2015_xlg <- res2015_l[which(lapply(res2015_l,length)>2)]
res2015_p <- unique(sapply(res2015_xlg,"[[",1))
res2016_xlg <- res2016_l[which(lapply(res2016_l,length)>2)]
res2016_p <- unique(sapply(res2016_xlg,"[[",1))
res2017_xlg <- res2017_l[which(lapply(res2017_l,length)>2)]
res2017_p <- unique(sapply(res2017_xlg,"[[",1))
res2018_xlg <- res2018_l[which(lapply(res2018_l,length)>2)]
res2018_p <- unique(sapply(res2018_xlg,"[[",1))
res2019_xlg <- res2019_l[which(lapply(res2019_l,length)>2)]
res2019_p <- unique(sapply(res2019_xlg,"[[",1))
res2020_xlg <- res2020_l[which(lapply(res2020_l,length)>2)]
res2020_p <- unique(sapply(res2020_xlg,"[[",1))

res_p <- unique(c(res2014_p,res2015_p,res2016_p,res2017_p,res2018_p,res2019_p,res2020_p))
jdf_subset <- jdf[which(jdf[,1] %in% res_p),]

#Number of journals with gene name errors in the supplementary files
journal_supplementary <- length(unique(aff_xls$V3))

# Number of articles with excel gene list
jdf <- unique(jdf_subset)
jdf_t <- table(jdf[,2])
jdf_t_df <- as.data.frame(jdf_t)

# Number of affected articles 
jres <- unique(aff_xls[,c(1,3)])
j_table <- table(jres[,2])
j_table_df <- as.data.frame(j_table)

# table content for gene name errors by journal 
jj <- merge(jdf_t_df,j_table_df,by="Var1")
colnames(jj) <- c("journal",
  "Number of articles with Excel gene lists",
  "Number of affected articles")

jj$`Proportion of articles affected` <- signif(jj[,3]/jj[,2]*100,3)
jjf <- jj[which(jj[,2]>49),]
jjf <- jjf[order(-jjf[,3]),]

jjf %>% kbl() %>%
  kable_paper("hover", full_width = F)

```

Here we need to create an object containing PMCID, journal name and year for the
11117 pubs with Excel gene lists, so that we can calculate yearly proportions later.

```{r,jdf2}

res2014_p_df <- as.data.frame(res2014_p)
colnames(res2014_p_df) <- "pmc"
res2014_p_df$year <- "2014"

res2015_p_df <- as.data.frame(res2015_p)
colnames(res2015_p_df) <- "pmc"
res2015_p_df$year <- "2015"

res2016_p_df <- as.data.frame(res2016_p)
colnames(res2016_p_df) <- "pmc"
res2016_p_df$year <- "2016"

res2017_p_df <- as.data.frame(res2017_p)
colnames(res2017_p_df) <- "pmc"
res2017_p_df$year <- "2017"

res2018_p_df <- as.data.frame(res2018_p)
colnames(res2018_p_df) <- "pmc"
res2018_p_df$year <- "2018"

res2019_p_df <- as.data.frame(res2019_p)
colnames(res2019_p_df) <- "pmc"
res2019_p_df$year <- "2019"

res2020_p_df <- as.data.frame(res2020_p)
colnames(res2020_p_df) <- "pmc"
res2020_p_df$year <- "2020"

pub_yr <- rbind(res2014_p_df, res2015_p_df, res2016_p_df, res2017_p_df, res2018_p_df, res2019_p_df, res2020_p_df)

jdf2 <- merge(jdf,pub_yr,by.x="V1",by.y="pmc")

```

## Top journals with more than 100 gene name errors articles from 2014 to 2020

Top six journals with most gene name errors were selected based on "Number of 
affected articles" in the Table 5 of the manuscript.

Accordingly, Nat Commun,PLoS One,Sci Rep,BMC Genomics,PLoS Genet,Oncotarget were
considered as top 6 journals with most gene name errors.
The number of publications published by each of these 6 journals in each year 
with gene name errors were counted and result was recorded.

```{r,top journals with more than 100 gene name errors articles from 2014 to 2020}

years <- c("2014","2015","2016","2017","2018","2019","2020")

aj2014 <- unique(pub_2014[,c(1,3)])
aj2015 <- unique(pub_2015[,c(1,3)])
aj2016 <- unique(pub_2016[,c(1,3)])
aj2017 <- unique(pub_2017[,c(1,3)])
aj2018 <- unique(pub_2018[,c(1,3)])
aj2019 <- unique(pub_2019[,c(1,3)])
aj2020 <- unique(pub_2020[,c(1,3)])

# Nature communication
nc_aff <- c(nrow(subset(aj2014[aj2014$V3=="Nat_Commun",])),
  nrow(subset(aj2015[aj2015$V3=="Nat_Commun",])),
  nrow(subset(aj2016[aj2016$V3=="Nat_Commun",])),
  nrow(subset(aj2017[aj2017$V3=="Nat_Commun",])),
  nrow(subset(aj2018[aj2018$V3=="Nat_Commun",])),
  nrow(subset(aj2019[aj2019$V3=="Nat_Commun",])),
  nrow(subset(aj2020[aj2020$V3=="Nat_Commun",])))

nc_gl <- c(nrow(unique(subset(jdf2,V2=="Nat_Commun"&year=="2014"))),
  nrow(unique(subset(jdf2,V2=="Nat_Commun"&year=="2015"))),
  nrow(unique(subset(jdf2,V2=="Nat_Commun"&year=="2016"))),
  nrow(unique(subset(jdf2,V2=="Nat_Commun"&year=="2017"))),
  nrow(unique(subset(jdf2,V2=="Nat_Commun"&year=="2018"))),
  nrow(unique(subset(jdf2,V2=="Nat_Commun"&year=="2019"))),
  nrow(unique(subset(jdf2,V2=="Nat_Commun"&year=="2020"))))

nc_df<- data.frame(years,nc_aff,nc_gl,signif(nc_aff/nc_gl*100,3))
colnames(nc_df) <- c("year","affected articles","articles with excel gene lists", "proportion of articles affected (%)")
nc_df%>%
  kbl() %>%
  kable_paper("hover", full_width = F)

# PLoS_One
po_aff <- c(nrow(subset(aj2014[aj2014$V3=="PLoS_One",])),
  nrow(subset(aj2015[aj2015$V3=="PLoS_One",])),
  nrow(subset(aj2016[aj2016$V3=="PLoS_One",])),
  nrow(subset(aj2017[aj2017$V3=="PLoS_One",])),
  nrow(subset(aj2018[aj2018$V3=="PLoS_One",])),
  nrow(subset(aj2019[aj2019$V3=="PLoS_One",])),
  nrow(subset(aj2020[aj2020$V3=="PLoS_One",])))

po_gl <- c(nrow(unique(subset(jdf2,V2=="PLoS_One"&year=="2014"))),
  nrow(unique(subset(jdf2,V2=="PLoS_One"&year=="2015"))),
  nrow(unique(subset(jdf2,V2=="PLoS_One"&year=="2016"))),
  nrow(unique(subset(jdf2,V2=="PLoS_One"&year=="2017"))),
  nrow(unique(subset(jdf2,V2=="PLoS_One"&year=="2018"))),
  nrow(unique(subset(jdf2,V2=="PLoS_One"&year=="2019"))),
  nrow(unique(subset(jdf2,V2=="PLoS_One"&year=="2020"))))

po_df<- data.frame(years,po_aff,po_gl,signif(po_aff/po_gl*100,3))
colnames(po_df) <- c("year","affected articles","articles with excel gene lists", "proportion of articles affected (%)")
po_df%>%
  kbl() %>%
  kable_paper("hover", full_width = F)

# Sci_Rep
sr_aff <- c(nrow(subset(aj2014[aj2014$V3=="Sci_Rep",])),
  nrow(subset(aj2015[aj2015$V3=="Sci_Rep",])),
  nrow(subset(aj2016[aj2016$V3=="Sci_Rep",])),
  nrow(subset(aj2017[aj2017$V3=="Sci_Rep",])),
  nrow(subset(aj2018[aj2018$V3=="Sci_Rep",])),
  nrow(subset(aj2019[aj2019$V3=="Sci_Rep",])),
  nrow(subset(aj2020[aj2020$V3=="Sci_Rep",])))

sr_gl <- c(nrow(unique(subset(jdf2,V2=="Sci_Rep"&year=="2014"))),
  nrow(unique(subset(jdf2,V2=="Sci_Rep"&year=="2015"))),
  nrow(unique(subset(jdf2,V2=="Sci_Rep"&year=="2016"))),
  nrow(unique(subset(jdf2,V2=="Sci_Rep"&year=="2017"))),
  nrow(unique(subset(jdf2,V2=="Sci_Rep"&year=="2018"))),
  nrow(unique(subset(jdf2,V2=="Sci_Rep"&year=="2019"))),
  nrow(unique(subset(jdf2,V2=="Sci_Rep"&year=="2020"))))

sr_df<- data.frame(years,sr_aff,sr_gl,signif(sr_aff/sr_gl*100,3))
colnames(sr_df) <- c("year","affected articles","articles with excel gene lists", "proportion of articles affected (%)")
sr_df%>%
  kbl() %>%
  kable_paper("hover", full_width = F)

# BMC_Genomics
bg_aff <- c(nrow(subset(aj2014[aj2014$V3=="BMC_Genomics",])),
  nrow(subset(aj2015[aj2015$V3=="BMC_Genomics",])),
  nrow(subset(aj2016[aj2016$V3=="BMC_Genomics",])),
  nrow(subset(aj2017[aj2017$V3=="BMC_Genomics",])),
  nrow(subset(aj2018[aj2018$V3=="BMC_Genomics",])),
  nrow(subset(aj2019[aj2019$V3=="BMC_Genomics",])),
  nrow(subset(aj2020[aj2020$V3=="BMC_Genomics",])))

bg_gl <- c(nrow(unique(subset(jdf2,V2=="BMC_Genomics"&year=="2014"))),
  nrow(unique(subset(jdf2,V2=="BMC_Genomics"&year=="2015"))),
  nrow(unique(subset(jdf2,V2=="BMC_Genomics"&year=="2016"))),
  nrow(unique(subset(jdf2,V2=="BMC_Genomics"&year=="2017"))),
  nrow(unique(subset(jdf2,V2=="BMC_Genomics"&year=="2018"))),
  nrow(unique(subset(jdf2,V2=="BMC_Genomics"&year=="2019"))),
  nrow(unique(subset(jdf2,V2=="BMC_Genomics"&year=="2020"))))

bg_df<- data.frame(years,bg_aff,bg_gl,signif(bg_aff/bg_gl*100,3))
colnames(bg_df) <- c("year","affected articles","articles with excel gene lists", "proportion of articles affected (%)")
bg_df%>%
  kbl() %>%
  kable_paper("hover", full_width = F)

# PLoS_Genet
pg_aff <- c(nrow(subset(aj2014[aj2014$V3=="PLoS_Genet",])),
  nrow(subset(aj2015[aj2015$V3=="PLoS_Genet",])),
  nrow(subset(aj2016[aj2016$V3=="PLoS_Genet",])),
  nrow(subset(aj2017[aj2017$V3=="PLoS_Genet",])),
  nrow(subset(aj2018[aj2018$V3=="PLoS_Genet",])),
  nrow(subset(aj2019[aj2019$V3=="PLoS_Genet",])),
  nrow(subset(aj2020[aj2020$V3=="PLoS_Genet",])))

pg_gl <- c(nrow(unique(subset(jdf2,V2=="PLoS_Genet"&year=="2014"))),
  nrow(unique(subset(jdf2,V2=="PLoS_Genet"&year=="2015"))),
  nrow(unique(subset(jdf2,V2=="PLoS_Genet"&year=="2016"))),
  nrow(unique(subset(jdf2,V2=="PLoS_Genet"&year=="2017"))),
  nrow(unique(subset(jdf2,V2=="PLoS_Genet"&year=="2018"))),
  nrow(unique(subset(jdf2,V2=="PLoS_Genet"&year=="2019"))),
  nrow(unique(subset(jdf2,V2=="PLoS_Genet"&year=="2020"))))

pg_df<- data.frame(years,pg_aff,pg_gl,signif(pg_aff/pg_gl*100,3))
colnames(pg_df) <- c("year","affected articles","articles with excel gene lists", "proportion of articles affected (%)")
pg_df%>%
  kbl() %>%
  kable_paper("hover", full_width = F)

# Oncotarget
ot_aff <- c(nrow(subset(aj2014[aj2014$V3=="Oncotarget",])),
  nrow(subset(aj2015[aj2015$V3=="Oncotarget",])),
  nrow(subset(aj2016[aj2016$V3=="Oncotarget",])),
  nrow(subset(aj2017[aj2017$V3=="Oncotarget",])),
  nrow(subset(aj2018[aj2018$V3=="Oncotarget",])),
  nrow(subset(aj2019[aj2019$V3=="Oncotarget",])),
  nrow(subset(aj2020[aj2020$V3=="Oncotarget",])))

ot_gl <- c(nrow(unique(subset(jdf2,V2=="Oncotarget"&year=="2014"))),
  nrow(unique(subset(jdf2,V2=="Oncotarget"&year=="2015"))),
  nrow(unique(subset(jdf2,V2=="Oncotarget"&year=="2016"))),
  nrow(unique(subset(jdf2,V2=="Oncotarget"&year=="2017"))),
  nrow(unique(subset(jdf2,V2=="Oncotarget"&year=="2018"))),
  nrow(unique(subset(jdf2,V2=="Oncotarget"&year=="2019"))),
  nrow(unique(subset(jdf2,V2=="Oncotarget"&year=="2020"))))

ot_df<- data.frame(years,ot_aff,ot_gl,signif(ot_aff/ot_gl*100,3))
colnames(ot_df) <- c("year","affected articles","articles with excel gene lists", "proportion of articles affected (%)")
ot_df%>%
  kbl() %>%
  kable_paper("hover", full_width = F)

```

## Plots for figure 2 of the manuscript

Temporal trends for the six journals with most gene name errors from 2014 to 
2020 was observed and Figure 2 in the manuscript was reproduced. 

```{r,plot2,fig.height=9,fig.width=6}

years <- c("2014","2015","2016","2017","2018","2019","2020")

par(mfrow=c(3,1))
# line diagrams on the number of gene name error articles published by  journal per year

## Nature communication
barplot(nc_df[,3],ylab="Publications with Excel gene lists",xlab="",
  names.arg = years, main="Nature Communications")
grid()
barplot(nc_df[,2],ylab="Affected publications",xlab="",names.arg = years)
grid()
plot(x=nc_df[,1],y=nc_df[,2]/nc_df[,3]*100,ylab ="Proportion of publications affected (%)",xlab = "",type = "b",pch=19,bty="n")
grid()

## PLOS ONE
barplot(po_df[,3],ylab="Publications with Excel gene lists",xlab="",
  names.arg = years, main="PLOS ONE")
grid()
barplot(po_df[,2],ylab="Affected publications",xlab="",names.arg = years)
grid()
plot(x=po_df[,1],y=po_df[,2]/po_df[,3]*100,ylab ="Proportion of publications affected (%)",xlab = "",type = "b",pch=19,bty="n")
grid()

## Scientific Reports
barplot(sr_df[,3],ylab="Publications with Excel gene lists",xlab="",
  names.arg = years, main="Scientific Reports")
grid()
barplot(sr_df[,2],ylab="Affected publications",xlab="",names.arg = years)
grid()
plot(x=sr_df[,1],y=sr_df[,2]/sr_df[,3]*100,ylab ="Proportion of publications affected (%)",xlab = "",type = "b",pch=19,bty="n")
grid()

## BMC_Genomics
barplot(bg_df[,3],ylab="Publications with Excel gene lists",xlab="",
  names.arg = years, main="BMC Genomics")
grid()
barplot(bg_df[,2],ylab="Affected publications",xlab="",names.arg = years)
grid()
plot(x=bg_df[,1],y=bg_df[,2]/bg_df[,3]*100,ylab ="Proportion of publications affected (%)",xlab = "",type = "b",pch=19,bty="n")
grid()

## PLoS Genetics
barplot(pg_df[,3],ylab="Publications with Excel gene lists",xlab="",
  names.arg = years, main="PLoS Genetics")
grid()
barplot(pg_df[,2],ylab="Affected publications",xlab="",names.arg = years)
grid()
plot(x=pg_df[,1],y=pg_df[,2]/pg_df[,3]*100,ylab ="Proportion of publications affected (%)",xlab = "",type = "b",pch=19,bty="n")
grid()

## Oncotarget
barplot(ot_df[,3],ylab="Publications with Excel gene lists",xlab="",
  names.arg = years, main="Oncotarget")
grid()
barplot(ot_df[,2],ylab="Affected publications",xlab="",names.arg = years)
grid()
plot(x=ot_df[,1],y=ot_df[,2]/ot_df[,3]*100,ylab ="Proportion of publications affected (%)",xlab = "",type = "b",pch=19,bty="n")
grid()

## now make the pdf
pdf("fig2.pdf",width=4,height=7) 
par(mfrow=c(3,1))

## Nature communication
barplot(nc_df[,3],ylab="Publications with Excel gene lists",xlab="",
  names.arg = years, main="Nature Communications")
grid()
barplot(nc_df[,2],ylab="Affected publications",xlab="",names.arg = years)
grid()
plot(x=nc_df[,1],y=nc_df[,2]/nc_df[,3]*100,ylab ="Proportion of publications affected (%)",xlab = "",type = "b",pch=19,bty="n")
grid()

## PLOS ONE
barplot(po_df[,3],ylab="Publications with Excel gene lists",xlab="",
  names.arg = years, main="PLOS ONE")
grid()
barplot(po_df[,2],ylab="Affected publications",xlab="",names.arg = years)
grid()
plot(x=po_df[,1],y=po_df[,2]/po_df[,3]*100,ylab ="Proportion of publications affected (%)",xlab = "",type = "b",pch=19,bty="n")
grid()

## Scientific Reports
barplot(sr_df[,3],ylab="Publications with Excel gene lists",xlab="",
  names.arg = years, main="Scientific Reports")
grid()
barplot(sr_df[,2],ylab="Affected publications",xlab="",names.arg = years)
grid()
plot(x=sr_df[,1],y=sr_df[,2]/sr_df[,3]*100,ylab ="Proportion of publications affected (%)",xlab = "",type = "b",pch=19,bty="n")
grid()

## BMC_Genomics
barplot(bg_df[,3],ylab="Publications with Excel gene lists",xlab="",
  names.arg = years, main="BMC Genomics")
grid()
barplot(bg_df[,2],ylab="Affected publications",xlab="",names.arg = years)
grid()
plot(x=bg_df[,1],y=bg_df[,2]/bg_df[,3]*100,ylab ="Proportion of publications affected (%)",xlab = "",type = "b",pch=19,bty="n")
grid()

## PLoS Genetics
barplot(pg_df[,3],ylab="Publications with Excel gene lists",xlab="",
  names.arg = years, main="PLoS Genetics")
grid()
barplot(pg_df[,2],ylab="Affected publications",xlab="",names.arg = years)
grid()
plot(x=pg_df[,1],y=pg_df[,2]/pg_df[,3]*100,ylab ="Proportion of publications affected (%)",xlab = "",type = "b",pch=19,bty="n")
grid()

## Oncotarget
barplot(ot_df[,3],ylab="Publications with Excel gene lists",xlab="",
  names.arg = years, main="Oncotarget")
grid()
barplot(ot_df[,2],ylab="Affected publications",xlab="",names.arg = years)
grid()
plot(x=ot_df[,1],y=ot_df[,2]/ot_df[,3]*100,ylab ="Proportion of publications affected (%)",xlab = "",type = "b",pch=19,bty="n")
grid()

dev.off()

```

## Journals error articles in refernce to yearly basis

All the journals from 2014 to 2020 which contain  more than 10 gene name error
publications.

Later we have output top 10 journals with gene name errors for each year from 
2014 to 2020 with " head(aj20**_j_dsc,10)

```{r,journals error articles in reference to yearly basis}

aj2014_tab <- table(aj2014[,2])
aj2015_tab <- table(aj2015[,2])
aj2016_tab <- table(aj2016[,2])
aj2017_tab <- table(aj2017[,2])
aj2018_tab <- table(aj2018[,2])
aj2019_tab <- table(aj2019[,2])
aj2020_tab <- table(aj2020[,2])

aj2020_df <- as.data.frame(aj2020_tab)
aj2020_j <- aj2020_df[which(aj2020_df[,2]>10),]
aj2020_j_dsc <- aj2020_df[order(-aj2020_df[,2]),]
head(aj2020_j_dsc,10)

aj2019_df <- as.data.frame(aj2019_tab)
aj2019_j <- aj2019_df[which(aj2019_df[,2]>10),]
aj2019_j_dsc <- aj2019_df[order(-aj2019_df[,2]),]
head(aj2019_j_dsc,10)

aj2018_df <- as.data.frame(aj2018_tab)
aj2018_j <- aj2018_df[which(aj2018_df[,2]>10),]
aj2018_j_dsc <- aj2018_df[order(-aj2018_df[,2]),]
head(aj2018_j_dsc,10)

aj2017_df <- as.data.frame(aj2017_tab)
aj2017_j <- aj2017_df[which(aj2017_df[,2]>10),]
aj2017_j_dsc <- aj2017_df[order(-aj2017_df[,2]),]
head(aj2017_j_dsc,10)

aj2016_df <- as.data.frame(aj2016_tab)
aj2016_j <- aj2016_df[which(aj2016_df[,2]>10),]
aj2016_j_dsc <- aj2016_df[order(-aj2016_df[,2]),]
head(aj2016_j_dsc,10)

aj2015_df <- as.data.frame(aj2015_tab)
aj2015_j <- aj2015_df[which(aj2015_df[,2]>10),]
aj2015_j_dsc <- aj2015_df[order(-aj2015_df[,2]),]
head(aj2015_j_dsc,10)

aj2014_df <- as.data.frame(aj2014_tab)
aj2014_j <- aj2014_df[which(aj2014_df[,2]>10),]
aj2014_j_dsc <- aj2014_df[order(-aj2014_df[,2]),]
head(aj2014_j_dsc,10)

aj2020_df <- as.data.frame(aj2020_tab)
aj2020_j <- aj2020_df[which(aj2020_df[,2]>10),]
aj2020_j_dsc <- aj2020_df[order(-aj2020_df[,2]),]
head(aj2020_j_dsc,10)

```


## Consistency between this and our previous analysis

Focus on plos one in the period 2014,2015.
Previously we found 60 studies.
Here we find 115 studies.
Of these 56 are common to both.

```{r,plosone}

prev <- read.table("plosone_20142015.tsv",header=TRUE,sep="\t")
prev <- subset(prev,Confirmed=="Confirmed")
tail(prev)
prev_pmc <- unique(prev$PMCID)
length(prev_pmc)


new <- subset(aff_xls,V3=="PLoS_One")
new <- subset(new, V4=="2014" | V4 == "2015")
new <- new[,c(1,3,4)]
new_pmc <- unique(new$V1)
length(new_pmc)

v1 <- list("Prev"=prev_pmc,"New"=new_pmc)
plot(euler(v1),quantities = TRUE)

# PMCs specific to 2016 study
setdiff(prev_pmc,new_pmc)

# PMCs specific to 2021 study
setdiff(new_pmc,prev_pmc)

```

## Journal impact factor correlation

Journal Citation Reports 2020 (Impact factor & Ranking of 2019).
InCites Journal Citation Reports (Clarivate Analytics).

```{r,jif, fig.height=7,fig.width=7}

jifs <- read.table("jifs.tsv",header=TRUE)
proportions <- jjf[,c(1,4)]
myjifs <- merge(proportions, jifs, by.x="journal",by.y="Journal")
cor.test(myjifs$JIF,myjifs$`Proportion of articles affected`)
cor.test(myjifs$JIF,myjifs$`Proportion of articles affected`,method="s")

mylm <- lm(myjifs$`Proportion of articles affected` ~ myjifs$JIF)
summary(mylm)

plot(myjifs$JIF,myjifs$`Proportion of articles affected`,
  xlab="JIF", ylab="Proportion of articles affected (%)",
  main="Articles with supplementary Excel gene lists")
abline(mylm)

```

## Session information

For reproducibility.

```{r,sessioninfo}

sessionInfo() 

```
